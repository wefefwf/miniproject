<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.springbootsmini.app.mapper.HospitalMapper">

<!-- 병원 삭제 -->
<delete id="deleteHospital" parameterType = "int">
DELETE FROM hospital WHERE hospital_id= #{hospitalId}
</delete>

<!-- 좋아요 싫어요 업데이트 -->
<update id="updateGoodBad">
UPDATE  hospital
<set>
<if test="type eq 'good'">
     good = good + 1
 </if>
 <if test="type eq 'bad'">
     bad = bad + 1
 </if>
</set>
WHERE hospital_id =#{hospitalId}
</update>

<!-- 병원아이디에 해당하는 병원 게시물 가져오기 -->
<select id="getHospitalDetail" parameterType ="int" resultType ="Hospital">
SELECT 
        hospital_id,
        name,
        doctor_name AS doctorName,
        address,
        phone,
        content,
        main_image AS mainImage,
        latitude,
        longitude,
        created_at AS createdAt,
        good,
        bad
    FROM hospital
    WHERE hospital_id = #{hospitalId}
</select>

<!-- 병원 전체 게시글 갯수 가져오기 -->
<select id="getHospitalCount" parameterType= "String" resultType ="int">
SELECT COUNT(*)
FROM hospital 
<if test="address != null and address != ''">
    WHERE address LIKE CONCAT('%', #{address}, '%')
</if>
</select>

<!-- 병원 전체 리스트 가져오기 -->
<select id="getHospitalList" parameterType="String" resultType ="Hospital">
SELECT 
hospital_id as hospitalId,
name as name,
doctor_name as doctorName,
address as address,
phone as phone,
latitude as latitude,
longitude as longitude,
content as content,
main_image as mainImage,
created_at as createdAt,
good as good,
bad as bad
FROM hospital
 <if test="address != null and address != ''">
    WHERE address LIKE CONCAT('%', #{address}, '%')
  </if>
ORDER BY hospital_id DESC
LIMIT #{startRow},#{pageSize};
</select>



</mapper>