<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main_layout}">
<head>
    <meta charset="UTF-8">
    <title>ìƒí’ˆ ì •ë³´ ìˆ˜ì • - ReeFlo</title>
    <style>
        .admin-form-container { max-width: 650px; margin: 50px auto; padding: 40px; background: #ffffff; border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        .form-header { text-align: center; margin-bottom: 35px; }
        .form-header h2 { font-size: 26px; color: #2E7D32; font-weight: 800; }
        
        .input-group { margin-bottom: 35px; display: flex; flex-direction: column; } /* ìˆ˜ì§ ì •ë ¬ ê°•ì œ */
        
        /* [ìˆ˜ì •] ì œëª©ì´ ë¬´ì¡°ê±´ í•œ ì¤„ì„ ë‹¤ ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
        .input-group label { 
            display: block; 
            width: 100%;
            font-weight: 700; 
            color: #444; 
            margin-bottom: 15px; 
            font-size: 1.1rem;
        }
        
        .form-input { width: 100%; padding: 14px 18px; border: 2px solid #eee; border-radius: 12px; font-size: 15px; transition: 0.3s; box-sizing: border-box; }
        .form-input:focus { border-color: #4CAF50; outline: none; background-color: #f9fff9; }
        
        /* [ìˆ˜ì •] ì´ë¯¸ì§€ ë°•ìŠ¤ë¥¼ ì œëª© ì•„ë˜ë¡œ ì™„ì „íˆ ë¶„ë¦¬ */
        .current-img-box { 
            display: block;        /* inline-blockì—ì„œ blockìœ¼ë¡œ ë³€ê²½ */
            width: fit-content;    /* ì´ë¯¸ì§€ í¬ê¸°ì— ë§ì¶¤ */
            margin-bottom: 15px;   /* ì•„ë˜ íŒŒì¼ ë²„íŠ¼ê³¼ì˜ ê°„ê²© */
            padding: 12px; 
            background: #fcfcfc; 
            border: 1px dashed #ddd; 
            border-radius: 12px;
        }
        
        .img-preview-item { 
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .img-preview-item img { 
            width: 120px; 
            height: 120px; 
            object-fit: cover; 
            border-radius: 10px; 
            margin-bottom: 8px; 
            border: 1px solid #eee;
        }
        
        .img-preview-item span { font-size: 12px; color: #888; font-weight: 500; }

        .btn-group { display: flex; gap: 15px; margin-top: 40px; }
        .btn-save { flex: 2; background: #4CAF50; color: white; border: none; padding: 16px; border-radius: 12px; font-weight: 700; font-size: 1.1rem; cursor: pointer; transition: 0.3s; }
        .btn-save:hover { background: #2E7D32; transform: translateY(-2px); }
        .btn-cancel { flex: 1; background: #f5f5f5; color: #666; text-align: center; text-decoration: none; padding: 16px; border-radius: 12px; font-weight: 600; line-height: 1.3; }
        
        input[type="file"]::file-selector-button { background: #e8f5e9; color: #2E7D32; border: none; padding: 10px 18px; border-radius: 8px; cursor: pointer; margin-right: 15px; font-weight: 600; }
        .file-help-text { font-size: 12px; color: #999; margin-top: 8px; display: block; }
    </style>
</head>
<body>
    <div layout:fragment="content">
        <div class="admin-form-container">
            <div class="form-header">
                <h2>ğŸŒ¿ ìƒí’ˆ ì •ë³´ ìˆ˜ì •</h2>
            </div>

            <form th:action="@{/productUpdate}" method="post" enctype="multipart/form-data">
                <input type="hidden" name="product_id" th:value="${product.product_id}">
                
                <div class="input-group">
                    <label>ì¹´í…Œê³ ë¦¬ ì„ íƒ</label>
                    <select name="category_id" class="form-input" required>
                        <option th:each="c : ${cList}" 
                                th:value="${c.category_id}" 
                                th:text="${c.category_name}"
                                th:selected="${c.category_id == product.category_id}"></option>
                    </select>
                </div>

                <div class="input-group">
                    <label>ìƒí’ˆëª…</label>
                    <input type="text" name="product_name" class="form-input" th:value="${product.product_name}" required>
                </div>

                <div class="input-group">
                    <label>íŒë§¤ ê°€ê²©</label>
                    <input type="number" name="price" class="form-input" th:value="${product.price}" required>
                </div>

                <div class="input-group">
                    <label>ë©”ì¸ ìƒí’ˆ ì´ë¯¸ì§€</label>
                    <div th:if="${product.image_url != null and product.image_url != ''}" class="current-img-box">
                        <div class="img-preview-item">
                            <img th:src="${product.image_url}" alt="í˜„ì¬ ë©”ì¸">
                            <span>í˜„ì¬ ë“±ë¡ëœ ì´ë¯¸ì§€</span>
                        </div>
                    </div>
                    <input type="file" name="file1" class="form-input" accept="image/*">
                    <p class="file-help-text">* ì´ë¯¸ì§€ë¥¼ ë³€ê²½í•  ê²½ìš°ì—ë§Œ ìƒˆ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.</p>
                </div>
                
                <div class="input-group">
                    <label>ìƒì„¸ ì´ë¯¸ì§€ 1 (ì„ íƒ)</label>
                    <div th:if="${product.image_url2 != null and product.image_url2 != ''}" class="current-img-box">
                        <div class="img-preview-item">
                            <img th:src="${product.image_url2}" alt="í˜„ì¬ ìƒì„¸1">
                            <span>í˜„ì¬ ë“±ë¡ëœ ì´ë¯¸ì§€</span>
                        </div>
                    </div>
                    <input type="file" name="file2" class="form-input" accept="image/*">
                </div>
                
                <div class="input-group">
                    <label>ìƒì„¸ ì´ë¯¸ì§€ 2 (ì„ íƒ)</label>
                    <div th:if="${product.image_url3 != null and product.image_url3 != ''}" class="current-img-box">
                        <div class="img-preview-item">
                            <img th:src="${product.image_url3}" alt="í˜„ì¬ ìƒì„¸2">
                            <span>í˜„ì¬ ë“±ë¡ëœ ì´ë¯¸ì§€</span>
                        </div>
                    </div>
                    <input type="file" name="file3" class="form-input" accept="image/*">
                </div>

                <div class="input-group">
                    <label>ìƒí’ˆ ìƒì„¸ ì„¤ëª…</label>
                    <textarea name="description" class="form-input" rows="6" th:text="${product.description}"></textarea>
                </div>

                <div class="btn-group">
                    <button type="submit" class="btn-save">ì •ë³´ ìˆ˜ì •í•˜ê¸°</button>
                    <a th:href="@{/productList(category_id=${product.category_id})}" class="btn-cancel">ì·¨ì†Œ</a>
                </div>
            </form>
        </div>
    </div>
</body>
</html>